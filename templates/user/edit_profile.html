{% extends "layout.html" %}

{% block content %}
{% if messages %}
    {% for message in messages %}
    <div class="alert alert-{{message.tags}} alert-dismissible fade show m-0" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
{% endif %}


<div class="container-md my-4">
    <div class="card mx-auto shadow" style="max-width: 70vw; font-size: 1rem;">
        <div class="card-body p-3">
            <form action="" method=POST>
                {% csrf_token %}

                {% if user.groups.all.0.name == "student" %}
                <h1>Edit Student Profile</h1>
                <hr>
                <!--  Programme -->
                <div class="mb-3">
                    <label for="id_programme" class="form-label">{{student_form.programme.label}}</label>
                    <select name="programme" required="" id="id_programme" class="form-select">
                        <option value="">Select a programme</option>
                        {% for programme_obj in student_form.fields.programme.queryset %}
                            <option value="{{ programme_obj.id }}" {% if programme_obj.id == student_profile.programme.id %}selected{%endif%}>{{ programme_obj.name }}</option>
                        {% endfor %}
                    </select>
                    </select>
                </div>
                <!-- First Name, Last Name in a Row -->
                <div class="row mb-3">
                    <div class="col-12 col-md-6">
                        <label for="id_first_name" class="form-label">{{user_form.first_name.label|title}}</label>
                        <input type="text" name="first_name" value="{{request.user.first_name}}" required="" id="id_first_name" class="form-control">
                    </div>
                    
                    <div class="col-12 col-md-6">
                        <label for="id_last_name" class="form-label">{{ user_form.last_name.label|title }}</label>
                        <input type="text" name="last_name" value="{{ request.user.last_name }}" required="" id="id_last_name" class="form-control">
                    </div>
                </div>

                <!-- Email and Phone Number in a Row -->
                <div class="row mb-3">
                    <div class="col-12 col-md-6">
                        <label for="id_email" class="form-label">{{ user_form.email.label }}</label>
                        <input type="email" name="email" value="{{ request.user.email }}" maxlength="320" required="" id="id_email" class="form-control" readonly>
                    </div>
                    <div class="col-12 col-md-6">
                        <label for="id_phone_num" class="form-label">{{ student_form.phone_num.label|title }}</label>
                        <input type="tel" name="phone_num" value="{{ student_profile.phone_num }}" required="" id="id_phone_num" class="form-control">
                    </div>
                </div>

                <!-- Year and Semester -->
                <div class="row mb-2">
                    <div class="col">
                        <label for="id_year" class="form-label">Registration Date</label>
                        <input type="date" name="date" class="form-control" id="id_date" value="{{student_profile.register_date|date:'Y-m-d'}}" placeholder="Years Entered University">
                    </div>
                    <div class="col">
                    </div>
                </div>
                
                {% endif %}

                {% if user.groups.all.0.name == "lecturer" %}
                <h2>Edit Lecturer Profile</h2>
                <hr>
                <!-- Faculty -->
                <div class="mb-3">
                    <label for="id_faculty" class="form-label">Faculty</label>
                    <select name="faculty" required="" id="id_faculty" class="form-select">
                        <option value="">Select a Faculty</option>
                        {% for faculty_obj in lecturer_form.fields.faculty.queryset %}
                            <option value="{{ faculty_obj.id }}" {% if faculty_obj.id == lecturer_profile.faculty.id %}selected{%endif%}>{{ faculty_obj.name }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Title, First Name, and Last Name in a Row -->
                <div class="row mb-3">
                    <div class="col-12 col-md-4">
                        <label for="id_title" class="form-label">{{ lecturer_form.title.label|title }}</label>
                        <input type="text" name="title" value="{{ lecturer_profile.title }}" required="" id="id_title" class="form-control">
                    </div>
                    <div class="col-12 col-md-4">
                        <label for="id_first_name" class="form-label">{{ user_form.first_name.label|title }}</label>
                        <input type="text" name="first_name" value="{{ request.user.first_name }}" required="" id="id_first_name" class="form-control">
                    </div>
                    <div class="col-12 col-md-4">
                        <label for="id_last_name" class="form-label">{{ user_form.last_name.label|title }}</label>
                        <input type="text" name="last_name" value="{{ request.user.last_name }}" required="" id="id_last_name" class="form-control">
                    </div>
                </div>

                <!-- Email and Phone Number in a Row -->
                <div class="row mb-3">
                    <div class="col-12 col-md-6">
                        <label for="id_email" class="form-label">{{ user_form.email.label }}</label>
                        <input type="email" name="email" value="{{ request.user.email }}" maxlength="320" required="" id="id_email" class="form-control" readonly>
                    </div>
                    <div class="col-12 col-md-6">
                        <label for="id_phone_num" class="form-label">{{ lecturer_form.phone_num.label|title }}</label>
                        <input type="tel" name="phone_num" value="{{ lecturer_profile.phone_num }}" required="" id="id_phone_num" class="form-control">
                    </div>
                </div>

                {% endif %}
                <div class="d-flex justify-content-center mt-4">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock content %}